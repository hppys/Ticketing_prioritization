2025-07-17 15:48:58,208 - INFO - Cron job started: Processing pending tickets.
2025-07-17 15:48:58,377 - INFO - Loaded 100 documents from database
2025-07-17 15:49:00,328 - INFO - Successfully added 100 documents to vector store
2025-07-17 15:49:00,331 - INFO - RAG system initialized successfully
2025-07-17 15:49:00,362 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-17 15:49:00,393 - INFO - Ticket 46 status updated to processing
2025-07-17 15:49:01,322 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 57
}
].
2025-07-17 15:49:04,627 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 54
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-17 15:49:04,791 - INFO - Ticket 46 status updated to pending
2025-07-17 15:49:04,792 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-17 15:49:04,822 - INFO - Ticket 47 status updated to processing
2025-07-17 15:49:06,532 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 52
}
].
2025-07-17 15:49:08,789 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 49
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-17 15:49:08,827 - INFO - Ticket 47 status updated to pending
2025-07-17 15:49:08,827 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-17 15:49:08,827 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-17 15:49:08,827 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-17 15:49:08,827 - INFO - Cron job finished.
2025-07-18 08:30:49,739 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:30:54,016 - ERROR - Fatal error initializing RAG system: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
psycopg.OperationalError: connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 506, in create_vector_extension
    with self._engine.connect() as conn:
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
sqlalchemy.exc.OperationalError: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 173, in initialize_rag_system
    vector_store = PGVector(
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 463, in __init__
    self.__post_init__()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 470, in __post_init__
    self.create_vector_extension()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 509, in create_vector_extension
    raise Exception(f"Failed to create vector extension: {e}") from e
Exception: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-18 08:30:54,082 - ERROR - Failed to initialize RAG system. Aborting job.
2025-07-18 08:31:27,439 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:31:27,662 - INFO - Loaded 100 documents from database
2025-07-18 08:31:29,626 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:31:29,630 - INFO - RAG system initialized successfully
2025-07-18 08:31:29,663 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:31:29,702 - INFO - Ticket 46 status updated to processing
2025-07-18 08:31:30,490 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 30
}
].
2025-07-18 08:31:32,744 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 28
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:31:32,902 - INFO - Ticket 46 status updated to pending
2025-07-18 08:31:32,902 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:31:32,933 - INFO - Ticket 47 status updated to processing
2025-07-18 08:31:33,716 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 27
}
].
2025-07-18 08:31:35,959 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 24
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:31:36,007 - INFO - Ticket 47 status updated to pending
2025-07-18 08:31:36,007 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:31:36,008 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-18 08:31:36,008 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-18 08:31:36,008 - INFO - Cron job finished.
2025-07-18 08:32:22,665 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:32:22,816 - INFO - Loaded 100 documents from database
2025-07-18 08:32:24,676 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:32:24,680 - INFO - RAG system initialized successfully
2025-07-18 08:32:24,715 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:32:24,747 - INFO - Ticket 46 status updated to processing
2025-07-18 08:32:25,521 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 35
}
].
2025-07-18 08:32:27,770 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 33
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:32:27,811 - INFO - Ticket 46 status updated to pending
2025-07-18 08:32:27,812 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:32:27,842 - INFO - Ticket 47 status updated to processing
2025-07-18 08:32:28,792 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 32
}
].
2025-07-18 08:32:31,047 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 29
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:32:31,088 - INFO - Ticket 47 status updated to pending
2025-07-18 08:32:31,088 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:32:31,088 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-18 08:32:31,088 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-18 08:32:31,088 - INFO - Cron job finished.
2025-07-18 08:33:02,996 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:33:03,144 - INFO - Loaded 100 documents from database
2025-07-18 08:33:05,052 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:33:05,054 - INFO - RAG system initialized successfully
2025-07-18 08:33:05,088 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:33:05,117 - INFO - Ticket 46 status updated to processing
2025-07-18 08:33:05,884 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 55
}
].
2025-07-18 08:33:08,138 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 52
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:33:08,183 - INFO - Ticket 46 status updated to pending
2025-07-18 08:33:08,183 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:33:08,214 - INFO - Ticket 47 status updated to processing
2025-07-18 08:33:09,118 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 51
}
].
2025-07-18 08:33:11,363 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 49
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:33:11,401 - INFO - Ticket 47 status updated to pending
2025-07-18 08:33:11,401 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:33:11,401 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-18 08:33:11,402 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-18 08:33:11,402 - INFO - Cron job finished.
2025-07-18 08:33:23,354 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:33:23,529 - INFO - Loaded 100 documents from database
2025-07-18 08:33:25,389 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:33:25,394 - INFO - RAG system initialized successfully
2025-07-18 08:33:25,424 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:33:25,571 - INFO - Ticket 46 status updated to processing
2025-07-18 08:33:26,317 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 34
}
].
2025-07-18 08:33:28,576 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "d:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 32
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "d:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:33:28,720 - INFO - Ticket 46 status updated to pending
2025-07-18 08:33:28,720 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:33:28,757 - INFO - Ticket 47 status updated to processing
2025-07-18 08:33:29,601 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 31
}
].
2025-07-18 08:33:31,844 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "d:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 29
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "d:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:33:31,880 - INFO - Ticket 47 status updated to pending
2025-07-18 08:33:31,881 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:33:31,881 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-18 08:33:31,881 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-18 08:33:31,881 - INFO - Cron job finished.
2025-07-18 08:34:15,404 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:34:15,545 - INFO - Loaded 100 documents from database
2025-07-18 08:34:17,398 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:34:17,401 - INFO - RAG system initialized successfully
2025-07-18 08:34:17,433 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:34:17,466 - INFO - Ticket 46 status updated to processing
2025-07-18 08:34:18,222 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 42
}
].
2025-07-18 08:34:20,463 - ERROR - Error processing ticket 46: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 40
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:34:20,507 - INFO - Ticket 46 status updated to pending
2025-07-18 08:34:20,507 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:34:20,540 - INFO - Ticket 47 status updated to processing
2025-07-18 08:34:21,486 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 39
}
].
2025-07-18 08:34:23,722 - ERROR - Error processing ticket 47: local variable 'result' referenced before assignment
Traceback (most recent call last):
  File "D:\interface\testing.py", line 227, in parse_rag_output
    result = rag_chain.invoke(inputs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 511, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1940, in _call_with_config
    context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\passthrough.py", line 497, in _invoke
    **self.mapper.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in invoke
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3774, in <dictcomp>
    output = {key: future.result() for key, future in zip(steps, futures)}
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 458, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3758, in _invoke_step
    return context.run(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5431, in invoke
    return self.bound.invoke(
  File "D:\interface\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3047, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1326, in invoke
    return super().invoke(input, config, stop=stop, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 378, in invoke
    self.generate_prompt(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 963, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 782, in generate
    self._generate_with_cache(
  File "D:\interface\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 1028, in _generate_with_cache
    result = self._generate(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 1433, in _generate
    response: GenerateContentResponse = _chat_with_retry(
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 231, in _chat_with_retry
    return _chat_with_retry(**params)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 187, in reraise
    raise self.last_attempt.result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 451, in result
    return self.__get_result()
  File "C:\laragon\bin\python\python-3.10\lib\concurrent\futures\_base.py", line 403, in __get_result
    raise self._exception
  File "D:\interface\.venv\lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 222, in _chat_with_retry
    raise e
  File "D:\interface\.venv\lib\site-packages\langchain_google_genai\chat_models.py", line 206, in _chat_with_retry
    return generation_method(**kwargs)
  File "D:\interface\.venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 868, in generate_content
    response = rpc(
  File "D:\interface\.venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\interface\.venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 147, in retry_target
    result = target()
  File "D:\interface\.venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\interface\.venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 37
}
]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 274, in process_single_ticket
    result = rag_chain_parser({"input": question})
  File "D:\interface\testing.py", line 244, in parse_rag_output
    logger.error(f"RAG parsing error: {e}. Raw answer: {result.get('answer', 'N/A')}")
UnboundLocalError: local variable 'result' referenced before assignment
2025-07-18 08:34:23,771 - INFO - Ticket 47 status updated to pending
2025-07-18 08:34:23,771 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:34:23,771 - WARNING - Failed ticket ID 46: Error: local variable 'result' referenced before assignment
2025-07-18 08:34:23,772 - WARNING - Failed ticket ID 47: Error: local variable 'result' referenced before assignment
2025-07-18 08:34:23,772 - INFO - Cron job finished.
2025-07-18 08:37:48,970 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:37:49,122 - INFO - Loaded 100 documents from database
2025-07-18 08:37:50,997 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:37:51,000 - INFO - RAG system initialized successfully
2025-07-18 08:37:51,041 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:37:51,083 - INFO - Ticket 46 status updated to processing
2025-07-18 08:37:51,888 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 9
}
].
2025-07-18 08:37:54,147 - ERROR - RAG parsing error: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]. Raw answer: N/A
2025-07-18 08:37:54,148 - ERROR - Error processing ticket 46: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]
Traceback (most recent call last):
  File "D:\interface\testing.py", line 280, in process_single_ticket
    raise Exception(f"Parsing failed: {result['parse_error']}")
Exception: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]
2025-07-18 08:37:54,189 - INFO - Ticket 46 status updated to pending
2025-07-18 08:37:54,189 - INFO - Waiting for 15 seconds to avoid API rate limit...
2025-07-18 08:38:09,195 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:38:09,234 - INFO - Ticket 47 status updated to processing
2025-07-18 08:38:09,906 - WARNING - Retrying langchain_google_genai.chat_models._chat_with_retry.<locals>._chat_with_retry in 2.0 seconds as it raised ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 51
}
].
2025-07-18 08:38:12,160 - ERROR - RAG parsing error: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 48
}
]. Raw answer: N/A
2025-07-18 08:38:12,160 - ERROR - Error processing ticket 47: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 48
}
]
Traceback (most recent call last):
  File "D:\interface\testing.py", line 280, in process_single_ticket
    raise Exception(f"Parsing failed: {result['parse_error']}")
Exception: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 48
}
]
2025-07-18 08:38:12,197 - INFO - Ticket 47 status updated to pending
2025-07-18 08:38:12,197 - INFO - Waiting for 15 seconds to avoid API rate limit...
2025-07-18 08:38:27,207 - INFO - Batch processing finished. Processed: 2, Successful: 0.
2025-07-18 08:38:27,207 - WARNING - Failed ticket ID 46: Error: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]
2025-07-18 08:38:27,207 - WARNING - Failed ticket ID 47: Error: Parsing failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_input_token_count"
  quota_id: "GenerateContentInputTokensPerModelPerMinute-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 48
}
]
2025-07-18 08:38:27,208 - INFO - Cron job finished.
2025-07-18 08:41:07,174 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:41:07,345 - INFO - Loaded 100 documents from database
2025-07-18 08:41:09,222 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:41:09,225 - INFO - RAG system initialized successfully
2025-07-18 08:41:09,360 - INFO - Processing ticket 46: berapa kecepatan internet telkom ...
2025-07-18 08:41:09,396 - INFO - Ticket 46 status updated to processing
2025-07-18 08:41:22,519 - INFO - RAG result saved for ticket 46
2025-07-18 08:41:22,556 - INFO - Ticket 46 status updated to done
2025-07-18 08:41:22,557 - INFO - Successfully processed ticket 46
2025-07-18 08:41:22,557 - INFO - Waiting for 61 seconds to avoid API rate limit...
2025-07-18 08:42:23,571 - INFO - Processing ticket 47: bagimana jika no telkomsel udah mati...
2025-07-18 08:42:23,608 - INFO - Ticket 47 status updated to processing
2025-07-18 08:42:36,788 - INFO - RAG result saved for ticket 47
2025-07-18 08:42:36,820 - INFO - Ticket 47 status updated to done
2025-07-18 08:42:36,820 - INFO - Successfully processed ticket 47
2025-07-18 08:42:36,821 - INFO - Waiting for 61 seconds to avoid API rate limit...
2025-07-18 08:43:37,832 - INFO - Batch processing finished. Processed: 2, Successful: 2.
2025-07-18 08:43:37,833 - INFO - Cron job finished.
2025-07-18 08:46:10,815 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:46:10,965 - INFO - Loaded 100 documents from database
2025-07-18 08:46:12,870 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:46:12,872 - INFO - RAG system initialized successfully
2025-07-18 08:46:12,904 - INFO - Batch processing status: No pending tickets found
2025-07-18 08:46:12,904 - INFO - Cron job finished.
2025-07-18 08:46:28,445 - INFO - Cron job started: Processing pending tickets.
2025-07-18 08:46:28,592 - INFO - Loaded 100 documents from database
2025-07-18 08:46:30,535 - INFO - Successfully added 100 documents to vector store
2025-07-18 08:46:30,538 - INFO - RAG system initialized successfully
2025-07-18 08:46:30,572 - INFO - Batch processing status: No pending tickets found
2025-07-18 08:46:30,572 - INFO - Cron job finished.
2025-07-18 09:31:54,446 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:31:54,638 - INFO - Loaded 100 documents from database
2025-07-18 09:31:56,515 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:31:56,520 - INFO - RAG system initialized successfully
2025-07-18 09:31:56,551 - INFO - Processing ticket 49: Cara cek kuota telkomsel di my telkomsel...
2025-07-18 09:31:56,685 - INFO - Ticket 49 status updated to processing
2025-07-18 09:32:06,961 - INFO - RAG result saved for ticket 49
2025-07-18 09:32:06,991 - INFO - Ticket 49 status updated to done
2025-07-18 09:32:06,991 - INFO - Successfully processed ticket 49
2025-07-18 09:32:06,991 - INFO - Waiting for 61 seconds to avoid API rate limit...
2025-07-18 09:33:08,004 - INFO - Batch processing finished. Processed: 1, Successful: 1.
2025-07-18 09:33:08,004 - INFO - Cron job finished.
2025-07-18 09:37:22,747 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:37:22,900 - INFO - Loaded 100 documents from database
2025-07-18 09:37:24,775 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:37:24,778 - INFO - RAG system initialized successfully
2025-07-18 09:37:24,810 - INFO - Batch processing status: No pending tickets found
2025-07-18 09:37:24,810 - INFO - Cron job finished.
2025-07-18 09:41:04,656 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:41:04,807 - INFO - Loaded 100 documents from database
2025-07-18 09:41:06,675 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:41:06,682 - INFO - RAG system initialized successfully
2025-07-18 09:41:06,722 - INFO - Batch processing status: No pending tickets found
2025-07-18 09:41:06,725 - INFO - Cron job finished.
2025-07-18 09:41:31,151 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:41:31,448 - INFO - Loaded 100 documents from database
2025-07-18 09:41:33,453 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:41:33,455 - INFO - RAG system initialized successfully
2025-07-18 09:41:33,587 - INFO - Batch processing status: No pending tickets found
2025-07-18 09:41:33,588 - INFO - Cron job finished.
2025-07-18 09:46:03,571 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:46:03,837 - INFO - Loaded 100 documents from database
2025-07-18 09:46:05,816 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:46:05,819 - INFO - RAG system initialized successfully
2025-07-18 09:46:05,853 - INFO - Batch processing status: No pending tickets found
2025-07-18 09:46:05,853 - INFO - Cron job finished.
2025-07-18 09:51:03,326 - INFO - Cron job started: Processing pending tickets.
2025-07-18 09:51:03,471 - INFO - Loaded 100 documents from database
2025-07-18 09:51:05,373 - INFO - Successfully added 100 documents to vector store
2025-07-18 09:51:05,376 - INFO - RAG system initialized successfully
2025-07-18 09:51:05,412 - INFO - Processing ticket 50: bagaimana biaya saya bulan ini ...
2025-07-18 09:51:05,450 - INFO - Ticket 50 status updated to processing
2025-07-18 09:51:19,695 - INFO - RAG result saved for ticket 50
2025-07-18 09:51:19,726 - INFO - Ticket 50 status updated to done
2025-07-18 09:51:19,726 - INFO - Successfully processed ticket 50
2025-07-18 09:51:19,726 - INFO - Waiting for 61 seconds to avoid API rate limit...
2025-07-18 09:52:20,730 - INFO - Batch processing finished. Processed: 1, Successful: 1.
2025-07-18 09:52:20,730 - INFO - Cron job finished.
2025-07-18 15:35:49,505 - INFO - Cron job started: Processing pending tickets.
2025-07-18 15:35:53,771 - ERROR - Fatal error initializing RAG system: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
psycopg.OperationalError: connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 506, in create_vector_extension
    with self._engine.connect() as conn:
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
sqlalchemy.exc.OperationalError: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\interface\testing.py", line 178, in initialize_rag_system
    vector_store = PGVector(
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 463, in __init__
    self.__post_init__()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 470, in __post_init__
    self.create_vector_extension()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 509, in create_vector_extension
    raise Exception(f"Failed to create vector extension: {e}") from e
Exception: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-18 15:35:53,837 - ERROR - Failed to initialize RAG system. Aborting job.
2025-07-21 08:55:00,518 - INFO - Cron job started: Processing pending tickets.
2025-07-21 08:55:04,773 - ERROR - Fatal error initializing RAG system: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
psycopg.OperationalError: connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 506, in create_vector_extension
    with self._engine.connect() as conn:
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
sqlalchemy.exc.OperationalError: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\interface\testing.py", line 180, in initialize_rag_system
    vector_store = PGVector(
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 463, in __init__
    self.__post_init__()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 470, in __post_init__
    self.create_vector_extension()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 509, in create_vector_extension
    raise Exception(f"Failed to create vector extension: {e}") from e
Exception: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-21 08:55:04,838 - ERROR - Failed to initialize RAG system. Aborting job.
2025-07-21 08:55:28,363 - INFO - Cron job started: Processing pending tickets.
2025-07-21 08:55:28,817 - INFO - Loaded 100 documents from database
2025-07-21 08:55:30,932 - INFO - Successfully added 100 documents to vector store
2025-07-21 08:55:30,937 - INFO - RAG system initialized successfully
2025-07-21 08:55:30,984 - INFO - Batch processing status: No pending tickets found
2025-07-21 08:55:30,984 - INFO - Cron job finished.
2025-07-22 09:21:05,975 - INFO - Cron job started: Processing pending tickets.
2025-07-22 09:21:10,420 - ERROR - Fatal error initializing RAG system: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
psycopg.OperationalError: connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 506, in create_vector_extension
    with self._engine.connect() as conn:
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "D:\interface\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "D:\interface\.venv\lib\site-packages\psycopg\connection.py", line 125, in connect
    raise type(last_ex)("\n".join(lines)).with_traceback(None)
sqlalchemy.exc.OperationalError: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\interface\testing.py", line 183, in initialize_rag_system
    vector_store = PGVector(
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 463, in __init__
    self.__post_init__()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 470, in __post_init__
    self.create_vector_extension()
  File "D:\interface\.venv\lib\site-packages\langchain_postgres\vectorstores.py", line 509, in create_vector_extension
    raise Exception(f"Failed to create vector extension: {e}") from e
Exception: Failed to create vector extension: (psycopg.OperationalError) connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
Multiple connection attempts failed. All failures were:
- host: 'localhost', port: 6024, hostaddr: '::1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
- host: 'localhost', port: 6024, hostaddr: '127.0.0.1': connection failed: could not send data to server: Socket is not connected (0x00002749/10057)
could not send SSL negotiation packet: Socket is not connected (0x00002749/10057)
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-22 09:21:10,494 - ERROR - Failed to initialize RAG system. Aborting job.
